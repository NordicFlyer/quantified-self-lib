os:
  - linux
sudo: required
language: node_js
node_js:
  - "10.0.0"

cache:
  directories:
    - node_modules

branches:
  only:
    - master
    - develop

before_script:
  - npm install codecov -g
  - npm install -g codeclimate-test-reporter
  - npm install

script:
  - npm run test-coverage
  - npm run build

after_success:
  - codecov
  - test $TRAVIS_BRANCH = "master" && test $TRAVIS_PULL_REQUEST = "false" && CODECLIMATE_API_HOST=$CODECLIMATE_API_HOST CODECLIMATE_REPO_TOKEN=$CODECLIMATE_REPO_TOKEN_MASTER codeclimate-test-reporter < coverage/lcov.info
  - test $TRAVIS_BRANCH = "develop" && test $TRAVIS_PULL_REQUEST = "false" && CODECLIMATE_API_HOST=$CODECLIMATE_API_HOST CODECLIMATE_REPO_TOKEN=$CODECLIMATE_REPO_TOKEN_DEVELOP codeclimate-test-reporter < coverage/lcov.info

notifications:
  email:
    on_failure: change
    on_success: change
  slack: quantified-self-io:gWxqdRGo14eo9MoBMtIPX6ME

deploy:
  provider: npm
  email: jimmykane9@gmail.com
  skip_cleanup: true
  api_key:
    secure: 4XYZZylQwhdvRrUvB3UJTcOkyKMDpLf74NLRQoZc7j0GnHLZW5g5qnMMgzvjkA2hWGRiazvd4mFgAU9892WFpf4vtW5Re0tiP/UFr94MHXxbA1KSPwmAJh7VNRd6QCjphMl7fr7P7YF5SeWIX3fWD1xC7Dlz8H2VyzSZVQfdJwSci1PCJHcKNdxtA606lsHqFSYvZ66fskJRiWuyy8mZyFeTPPA0SVsZGwDP1cUnS3HQT8PdrDY35wv2OQYoIJLVn3neaJHQ+Tm0z1rO/y5rzq/FjFHULyiww8aQarqLyFNeFDSSTqddJLA1wbZ043IksdAntC4uaJXDs7oIljXTwrb0037JPmKeeovzEf/NeN0r9ys3jifBHCuWYCFd8n3LjXY02+pHBYK+AfTR+CVThs9TodheH7W3tSKkG8Law8oDhfmKic5gV7ULGOpHvT6XWyYgY3Oq03ha3vw9Ft7RkfNtKuMsK/TFmkkWuO4TEbjtkM1DAyCPr5ap6+r+7sX+1c5jWpL9Hdk9xC+xb0khHdvx7hqGayx7a+o0O0guctPgN7o2FP1sVaUjmlkXJEm9gYQEYQQ7ReSJtDFhxFo0sI///lbAw7YtYW68/1NTYE/pbnW0fMrQJMVu71fm39+cRXmktjSIUBCDvLL9s2hC21VO527WckYEa1gPVedyX2U=
  on:
    branch: master
