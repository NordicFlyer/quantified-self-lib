os:
  - linux
sudo: required
language: node_js
node_js:
  - "10.0.0"

cache:
  directories:
    - node_modules

branches:
  only:
    - master
    - develop

before_script:
  - npm install codecov -g
  - npm install -g codeclimate-test-reporter
  - npm install

script:
  - npm run test-coverage
  - npm run build

after_success:
  - codecov
  - test $TRAVIS_BRANCH = "master" && test $TRAVIS_PULL_REQUEST = "false" && CODECLIMATE_API_HOST=$CODECLIMATE_API_HOST CODECLIMATE_REPO_TOKEN=$CODECLIMATE_REPO_TOKEN_MASTER codeclimate-test-reporter < coverage/lcov.info
  - test $TRAVIS_BRANCH = "develop" && test $TRAVIS_PULL_REQUEST = "false" && CODECLIMATE_API_HOST=$CODECLIMATE_API_HOST CODECLIMATE_REPO_TOKEN=$CODECLIMATE_REPO_TOKEN_DEVELOP codeclimate-test-reporter < coverage/lcov.info

notifications:
  email:
    on_failure: change
    on_success: change
  slack: quantified-self-io:gWxqdRGo14eo9MoBMtIPX6ME

deploy:
  provider: npm
  email: jimmykane9@gmail.com
  skip_cleanup: true
  api_key:
    secure: k9gXOpFzROukztBd4sOcubfrCqxhNwRAEDUj4tAt6+lls6kRbXzYCbL4UtpuqyLWO6tzYgoBP2rxxkK8infFWnsfC6zvqjcTxWFBngpVspGTmfCb6tXKtIZXfPvwLgNhamdyWt6KHL5RvBqzliyF6yIWy9vAbdCYFb1zYKZ0O3Rxoqd2fDH3jkX0rPV/bYEFmrp7tonwg7BR5hmYOXaSRza/qMZ+6T/X8qec/YjhtMPaGxUKoVYzI7cV2fXgZStM99EUiO0FO1IERLKGz87BbCV2OCZ6o1vgGnNuScWG5K5Y24uDtk4OA2UPDKaNcDJV1o0cJKf9wwYZHj2IwN5HAPZUFgVmn1hE0NOB6mQPNI3XWHWX3F9mfn6NKfz6dQFbmhlBMthpQD7QvtG5/NlN/elmA3cLML35L+PfNr7sAeBJInCafXuwkAVje0WKoMle3u8Xa1AHRfoY6VNp0XWqkOtKsqqongIOmPhfoBIMo7eJ4MsdH1D5flSwuOzrqu6krm5CTR47+yi9DGtesFQ8NhOT7XiEnIScGRC7P4uvbwtILzLQDzENEw6BEk6mJOgTdO6vJaL826WyyVViRnCTLSPMr8IFkdNtFe5nKO1XB4vw/zB+Z3W4Hc1z5x2uTtqejODbJJ0VBSxiP6h8c0fHaa5n53b41DX6GJ0Seu4vevI=
  on:
    branch: master
